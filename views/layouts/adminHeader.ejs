<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Clemonic</title>
    <link rel="icon" href="/img/icon.ico">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
    <!-- overlayScrollbars -->
<!--    <link rel="stylesheet" href="/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">-->
    <!-- Theme style -->
    <link rel="stylesheet" href="/css/adminlte.min.css">

    <link rel="stylesheet" href="/css/datatables.min.css">

    <link rel="stylesheet" href="/css/bootstrap-select.css">

    <link rel="stylesheet" href="/css/toastr.css">

    <style>
        .btn-violet{
            background: mediumorchid;
            color: white;
        }
        .btn-violet:hover{
            background: darkmagenta;
            color: wheat;
        }
    </style>

</head>
<body class="hold-transition sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed" >
<div class="wrapper">
    <!-- Navbar -->
    <nav class="main-header navbar navbar-expand navbar-white navbar-light" style="background: #f6f6f6">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
            </li>
            <li class="nav-item d-none d-sm-inline-block">
                <a href="/admin" class="nav-link">Admin Dashboard</a>
            </li>


        </ul>


<%

    const alertInsurancesTotal =  alertInsurances ? alertInsurances.length : 0;
    const alertRoadworthiesTotal = alertRoadworthies ? alertRoadworthies.length : 0;
    const alertDriversLicensesTotal = alertDriversLicenses ? alertDriversLicenses.length : 0;

    const totalAlerts =
                 parseInt(alertInsurances ? alertInsurances.length : 0)
                 + parseInt(alertRoadworthies ? alertRoadworthies.length : 0)
                 + parseInt(alertDriversLicenses ? alertDriversLicenses.length : 0)

%>







        <!-- Right navbar links -->
        <ul class="navbar-nav ml-auto">


            <% if(totalAlerts > 0){ %>

            <!-- Notifications Dropdown Menu -->
            <li class="nav-item dropdown">
                <a class="nav-link" data-toggle="dropdown" href="#">
                    <i class="far fa-bell"></i>
                    <span class="badge badge-warning navbar-badge"><%= totalAlerts %></span>
                </a>
                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                    <span class="dropdown-item dropdown-header"><%= totalAlerts %> Notification(s)</span>
                    <div class="dropdown-divider"></div>
                    <a href="#" data-toggle="modal" data-target="#insuranceNotification"  class="dropdown-item">
                        <i class="fas fa-list mr-2"></i> Insurance
                        <span class="float-right <%= alertInsurancesTotal > 0 ? 'text-danger' : 'text-success' %> text-sm">
                            <%= alertInsurancesTotal %> item(s)
                        </span>
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="#" class="dropdown-item" data-toggle="modal" data-target="#roadworthyNotification">
                        <i class="fas fa-archway mr-2"></i> Roadworthy
                        <span class="float-right <%= alertRoadworthiesTotal > 0 ? 'text-danger' : 'text-success' %> text-sm">
                            <%= alertRoadworthiesTotal %> item(s)
                        </span>
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="#" class="dropdown-item" data-toggle="modal" data-target="#driverLicenseNotification">
                        <i class="fas fa-id-card mr-2"></i> Drivers License
                        <span class="float-right <%= alertDriversLicensesTotal > 0 ? 'text-danger' : 'text-success' %> text-sm">
                            <%= alertDriversLicensesTotal %> item(s)
                        </span>
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="#" class="dropdown-item dropdown-footer"></a>
                </div>
            </li>
            <!-- ./Notifications Dropdown Menu -->

            <% } %>


            <li class="nav-item dropdown">

                <a href="#" data-toggle="dropdown" class="nav-link dropdown-toggle nav-link-lg nav-link-user" aria-expanded="true">
                    <i class="fas fa-user-circle"></i>
                    <div class="d-none d-md-inline-block">
                        <%= user ? "Hi " + user.firstName : ''%>
                    </div>
                </a>
                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                    <div class="dropdown-item dropdown-header">Welcome!</div>
                    <a href="/users/password/reset" class="dropdown-item has-icon">
                        <span class="fa fa-lock"></span>
                        Reset Password
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="/users/logout" class="dropdown-item has-icon  text-danger">
                        <span class="fa fa-sign-out-alt"></span>
                        Logout
                    </a>
                </div>
            </li>


        </ul>
    </nav>
    <!-- /.navbar -->

    <!-- Main Sidebar Container -->
    <aside class="main-sidebar  sidebar-dark-secondar= elevation-4">
        <!-- Brand Logo -->
        <a href="/" class="brand-link">
            <img src="/img/clemonic.png" class="brand-image img-circle elevation-3">

            <span class="brand-text font-weight-light text-white">Clemonic &reg;</span>
        </a>

        <!-- Sidebar -->
        <div class="sidebar">


            <!-- Sidebar Menu -->
            <nav class="mt-2">
                <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                    <!-- Add icons to the links using the .nav-icon class
                         with font-awesome or any other icon font library -->

                    <li class="nav-item">
                        <a href="/admin/assets" class="nav-link">
                            <i class="nav-icon fas fa-truck-moving"></i>
                            <p>
                                Assets(Trucks)

                            </p>
                        </a>
                    </li>

                    <li class="nav-header text-warning">ACCOUNTS</li>
                    <li class="nav-item has-treeview">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-money-check"></i>
                            <p>
                                Banking
                                <i class="right fas fa-angle-left"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="/admin/banking" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Account</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/admin/bankTransfers" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Transfer</p>
                                </a>
                            </li>

                        </ul>
                    </li>


                    <li class="nav-item has-treeview">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-money-bill"></i>
                            <p>
                                Cash
                                <i class="right fas fa-angle-left"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="/admin/cashAccounts" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Account</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/admin/cashTransfers" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Transfer</p>
                                </a>
                            </li>

                        </ul>
                    </li>
                    <br>


                    <!-- Vendors -->
                    <li class="nav-item">
                        <a href="/vendors" class="nav-link">
                            <i class="nav-icon fas fa-atom"></i>
                            <p>
                                Vendors
                            </p>
                        </a>
                    </li>
                    <li class="nav-header text-warning">Bills</li>
                    <li class="nav-item has-treeview">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-money-bill"></i>
                            <p>
                                Click To Expand
                                <i class="right fas fa-angle-left"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="/bills" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Create Bill</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/bills/pay" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Pay Bill</p>
                                </a>
                            </li>
                        </ul>
                    </li>

                        <!--  Expenditure  -->
                    <li class="nav-item mt-1">
                        <a href="/admin/expenses" class="nav-link">
                            <i class="nav-icon fas fa-atom"></i>
                            <p>
                                Expenses
                            </p>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="/depreciation" class="nav-link">
                            <i class="nav-icon fas fa-calculator"></i>
                            <p>
                                Depreciation
                            </p>
                        </a>
                    </li>


                    <li class="nav-item">
                        <a href="/trips" class="nav-link">
                            <i class="nav-icon fas fa-truck-loading"></i>
                            <p>
                               Trips
                            </p>
                        </a>
                    </li>



                    <li class="nav-header text-warning">SALES</li>
                    <li class="nav-item">
                        <a href="/admin/sales" class="nav-link">
                            <i class="nav-icon fas fa-calendar-alt"></i>
                            <p>
                                Record Sales
                            </p>
                        </a>
                    </li>

                    <!--  Insurance And Renewals   -->
                    <li class="nav-header text-warning">Insurance And Renewals</li>
                    <li class="nav-item has-treeview">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-money-bill"></i>
                            <p>
                                Click To Expand
                                <i class="right fas fa-angle-left"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="/admin/renewals/insurance" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Insurance</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/admin/renewals/roadworthy" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Roadworthy</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/admin/renewals/driversLicense" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Driver's License</p>
                                </a>
                            </li>

                        </ul>
                    </li>
                    <br>

                    <!--   Reports    -->
                    <li class="nav-item has-treeview">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-list"></i>
                            <p>
                                Reports
                                <i class="right fas fa-angle-left"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="/report/profitAndLoss" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Profit And Loss</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/report/balanceSheet" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Balance Sheet</p>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/activities" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Audit Trail</p>
                                </a>
                            </li>

                        </ul>
                    </li>

                                    <!--  Users    -->
                    <li class="nav-item">
                        <a href="/users" class="nav-link">
                            <i class="nav-icon fas fa-user-friends"></i>
                            <p>
                                Manage Users
                            </p>
                        </a>
                    </li>
                    <br>

                    <li class="nav-item">
                        <a href="/backup" class="nav-link" onclick="return confirm('You are about to back up the database. click ok to continue')">
                            <i class="nav-icon fas fa-database text-purple"></i>
                            <p>
                                Backup Database

                            </p>
                        </a>
                    </li>



                </ul>
                <br><br>
            </nav>
            <!-- /.sidebar-menu -->
        </div>
        <!-- /.sidebar -->
    </aside>





    <!-- insurance notification modal -->
    <div class="modal fade" id="insuranceNotification" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="myModalLabel" aria-hidden="true">
        <br><br>
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-center " id="exampleModalLabel"><i class="fas fa-bell text-danger"></i><span> Insurance Renewal Notifications</span></h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">


                    <div class="card shadow">
                        <div class="card-body">

                            <div class="table-responsive">
                                <% if (alertInsurancesTotal){ %>
                                    <table class="table table-sm table-borderless">

                                        <thead class="thead-dark">
                                        <tr>
                                            <th>Truck Number</th>
                                            <th>Renewal Date</th>
                                            <th>Expiration Date</th>
                                        </tr>
                                        </thead>


                                        <tbody>

                                        <% for(const insurance of alertInsurances){ %>

                                            <tr>
                                                <td><%= insurance.truck.licenseNumber%></td>
                                                <td><%= new Date(insurance.renewalDate).toDateString() %></td>
                                                <td class="text-danger"><b><%= new Date(insurance.expirationDate).toDateString() %></b></td>
                                            </tr>

                                        <% } %>


                                        </tbody>

                                    </table>
                                <% } else { %>

                                        <h3 class="text-center">No Record Found</h3>

                                    <%  } %>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- ./insurance notification modal -->






    <!-- Roadworthy notification modal -->
    <div class="modal fade" id="roadworthyNotification" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="myModalLabel" aria-hidden="true">
        <br><br>
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-center " id="exampleModalLabel"><i class="fas fa-bell text-danger"></i><span> Roadworthy Renewal Notifications</span></h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">


                    <div class="card shadow">
                        <div class="card-body">

                            <div class="table-responsive">
                                <% if (alertRoadworthiesTotal){ %>
                                    <table class="table table-sm table-borderless">

                                        <thead class="thead-dark">
                                        <tr>
                                            <th>Truck Number</th>
                                            <th>Renewal Date</th>
                                            <th>Expiration Date</th>
                                        </tr>
                                        </thead>


                                        <tbody>

                                        <% for(const roadworthy of alertRoadworthies){ %>

                                            <tr>
                                                <td><%= roadworthy.truck.licenseNumber%></td>
                                                <td><%= new Date(roadworthy.renewalDate).toDateString() %></td>
                                                <td class="text-danger"><b><%= new Date(roadworthy.expirationDate).toDateString() %></b></td>
                                            </tr>

                                        <% } %>


                                        </tbody>

                                    </table>
                                <% } else { %>

                                        <h3 class="text-center">No Record Found</h3>

                                    <%  } %>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- ./roadworthy notification modal -->





    <!-- Driver License notification modal -->
    <div class="modal fade" id="driverLicenseNotification" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="myModalLabel" aria-hidden="true">
        <br><br>
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-center " id="exampleModalLabel"><i class="fas fa-bell text-danger"></i><span> Drivers License Renewal Notifications</span></h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">


                    <div class="card shadow">
                        <div class="card-body">

                            <div class="table-responsive">
                                <% if (alertDriversLicensesTotal){ %>
                                    <table class="table table-sm table-borderless">

                                        <thead class="thead-dark">
                                        <tr>
                                            <th>Truck Number</th>
                                            <th>Driver's Name</th>
                                            <th>Renewal Date</th>
                                            <th>Expiration Date</th>
                                        </tr>
                                        </thead>


                                        <tbody>

                                        <% for(const license of alertDriversLicenses){ %>

                                            <tr>
                                                <td><%= license.truck%></td>
                                                <td><%= license.name%></td>
                                                <td><%= new Date(license.renewalDate).toDateString() %></td>
                                                <td class="text-danger"><b><%= new Date(license.expirationDate).toDateString() %></b></td>
                                            </tr>

                                        <% } %>


                                        </tbody>

                                    </table>
                                <% } else { %>

                                    <h3 class="text-center">No Record Found</h3>

                                <%  } %>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- ./Driver License  notification modal -->








    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" style="background: lightgrey !important;">

